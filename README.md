# 🚀 服务器监控系统

> 一站式、轻量级、现代化的 Linux 服务器运维监控平台。

## 📖 项目简介

本项目是一套基于 **Docker 容器化** 部署的服务器集群监控系统。旨在解决传统运维中手动登录服务器查看状态的低效问题。通过 Web 可视化界面，运维人员只需添加 SSH 连接信息，系统即可自动通过 Agentless（无代理）模式采集目标服务器的运行指标。

系统采用 **前后端分离** 架构，前端使用 ECharts 实现 1920x1080 自适应数据大屏，后端采用 Python Flask + SQLite 进行数据采集与持久化存储。

## ✨ 核心功能

- **📊 实时可视化大屏**：
  - 1920x1080 分辨率自适应布局，科幻风格 UI。
  - 实时展示 CPU、内存、磁盘使用率（仪表盘）。
  - 实时网络流量（上传/下载速率）波形图。
  - 资源历史趋势追踪（CPU/内存/磁盘曲线图）。
- **🤖 自动化采集 (Agentless)**：
  - 无需在被监控服务器上安装 Agent 软件。
  - 基于 SSH 协议，自动推送 Python 采集脚本，安全无侵入。
  - 支持所有主流 Linux 发行版（Ubuntu, CentOS, Debian 等）。
- **🚨 智能告警系统**：
  - 自动监测资源阈值（CPU/内存/磁盘）。
  - 告警信息流实时滚动展示，支持按严重程度（红色/黄色）区分。
  - 记录主机上线/下线状态。
- **🛡️ 安全与管理**：
  - **加密存储**：SSH 密码采用 Fernet 算法加密存储，保障凭证安全。
  - **便捷管理**：支持一键添加、删除主机。
  - **数据持久化**：SQLite 数据库存储历史监控数据，重启不丢失。

## 📂 目录结构

```
monitor-project/
├── docker-compose.yml       # Docker 容器编排文件（入口）
├── README.md                # 项目说明文档
├── backend/                 # 后端服务目录
│   ├── Dockerfile           # 后端镜像构建文件
│   ├── app.py               # Python 核心业务逻辑
│   └── requirements.txt     # Python 依赖库
├── frontend/                # 前端服务目录
│   ├── Dockerfile           # 前端镜像构建文件
│   ├── nginx.conf           # Nginx 服务器配置
│   └── index.html           # 监控大屏源码 (HTML/JS/CSS)
└── backend_data/            # [自动生成] 数据持久化目录
    ├── monitor_v2.db        # SQLite 数据库文件
    └── secret.key           # 密码加密密钥
```

## 🛠️ 部署指南

### 前置条件

- 已安装 **Docker** 和 **Docker Compose**。
- 确保 8080 端口未被占用。

### 启动步骤

1. **下载/解压项目代码**

   ```
   cd monitor-project
   ```

2. **构建并启动服务**

   ```
   # 该命令会自动构建镜像并后台运行
   docker-compose up --build -d
   ```

3. **验证运行状态**

   ```
   docker ps
   # 应当看到 monitor-frontend 和 monitor-backend 两个容器处于 Up 状态
   ```

4. 访问系统

   打开浏览器访问：http://localhost:8080 (或服务器 IP:8080)

## 📖 使用说明

### 1. 添加被监控主机

点击右上角的 **“+ 管理主机”** 按钮，在弹窗中输入：

- **IP 地址**：目标服务器的 IP（需确保 Docker 容器能 ping 通该 IP）。
- **SSH 用户名**：通常为 `root` 或具有 sudo 权限的用户。
- **SSH 密码**：目标主机的登录密码。
- **端口**：默认 22。

> **注意**：被监控的主机必须是 **Linux 系统** 且已安装 **Python 3**。

### 2. 查看监控数据

- **左侧列表**：显示所有已添加的主机。绿色点表示在线，红色点表示离线。
- **中间仪表盘**：点击左侧列表中的主机，中间区域会显示该主机的实时 CPU、内存、磁盘和负载信息。
- **底部趋势图**：显示最近 1 小时的资源使用走势（含磁盘监控）。
- **右侧流量图**：显示实时的网络上传/下载速度。

### 3. 删除主机

在左侧主机列表中，将鼠标悬停在主机条目上，点击右侧出现的 **红色垃圾桶图标** 即可删除主机及历史数据。

### 4. 告警查看

界面左下方的 **“告警情报中心”** 会实时刷新系统检测到的异常（如 CPU > 80% 或主机连接失败）。

## ⚙️ 技术栈

- **前端**：
  - HTML5 / CSS3 / JavaScript (ES6+)
  - **Tailwind CSS** (样式框架)
  - **ECharts 5.0** (数据可视化)
  - Nginx (Web 服务器 & 反向代理)
- **后端**：
  - **Python 3.9**
  - **Flask** (Web 框架)
  - **Paramiko** (SSH 连接与命令执行)
  - **SQLite** (轻量级数据库)
  - **Cryptography** (数据加密)
- **运维**：
  - Docker & Docker Compose

## ❓ 常见问题 (FAQ)

Q: 为什么添加主机显示“连接失败”？

A: 请检查：

1. 目标主机的 IP 是否正确。
2. 目标主机是否开启了 SSH 服务（端口 22）。
3. 监控系统所在的网络是否能访问目标 IP（防火墙设置）。

Q: 图表上的时间为什么不准确？

A: 系统已内置时区修正逻辑，会将 UTC 时间自动转换为 UTC+8（北京时间） 显示。如果仍有偏差，请检查宿主机的系统时间。

Q: 可以监控 Windows 服务器吗？

A: 目前版本仅支持 Linux 系统（因为采集脚本依赖 /proc 文件系统）。